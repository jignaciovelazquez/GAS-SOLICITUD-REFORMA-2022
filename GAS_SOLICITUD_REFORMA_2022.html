<!DOCTYPE html>
<html>

<head>
    <base target="_top">

</head>

<body>
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css">

    <div style="float:left; margin-right:10px; width: 50%">
        <div style="float:left; margin-right:100px">
            <h1> Solicitar Reformas </h1>
            <input type="text" id="ID" name="id" placeholder="Ingrese el ID"
                style="width:200px; height: 35px; font-size: 15px" required>
            <button class="action" id="buscar"
                style="margin-left:10px; width:50px; height: 35px; font-size: 15px">Buscar</button>
        </div>

        <div>
            <a title="MAPA" id="MAPA"
                href="https://www.google.com/maps/place/La+Concha+de+la+Lora+Restaurante+Argentino/@-0.2294661,-78.4944488,11.92z/      data=!4m5!3m4!1s0x91d59a0e8d79debd:0x731f926f07e60c9b!8m2!3d-0.2071356!4d-78.4829922"
                target="_blank"><img
                    src="https://i-cdn.phonearena.com/images/article/100654-image/Google-Maps-will-soon-track-your-public-transit-journey-in-real-time.jpg"
                    width="100px" height="100px" alt="Mapa"></a>
        </div>

        <h3>Tipo de Reforma a Solicitar</h3>
        <select name="tipo" id="TIPO" style="width:300px; height: 35px; margin-right:10px; font-size: 15px">
            <option value="0" selected></option>
            <option value="1">No hay tap hot disponible</option>
            <option value="2">Edificio no contemplado</option>
            <option value="3">No se puede tomar Tension</option>
            <option value="4">Niveles fuera de rango</option>
            <option value="10">Diseño Online HFC</option>
            <option value="5">Reforma Civil</option>
            <option value="6">FTTH - Detalle de Empalme</option>
            <option value="9">FTTH - Iluminacion de CAJA</option>
            <option value="7">FTTH - Extension de Red</option>
            <option value="8">FTTH - Reforma Civil</option>
        </select>
        <select name="red" id="RED" style="width:100px; height: 35px; margin-right:10px; font-size: 15px">
            <option value="0" selected></option>
            <option value="1">750MHz</option>
            <option value="2">1000MHz</option>
        </select>
        <select name="armado" id="ARMADO" style="width:130px; height: 35px; font-size: 15px">
            <option value="0" selected></option>
            <option value="EXTERIOR">EXTERIOR</option>
            <option value="MONTANTE">MONTANTE</option>
        </select>
        <br>
        <div id="DIV1" style="font-size: 15px">
            <br>
            <label>Nodo: </label>
            <input type="text" id="NODO" name="nodo" style="width:100px">
            <br>
            <br>
            <label>Dirección</label>
            <input type="text" id="DIRECCION" name="direccion" style="width:350px">
            <br>
            <br>
            <div id="DIV12">
                <label>Entre calles: </label>
                <input type="text" id="CALLE1" name="calle1" style="width:400px" placeholder="Ingrese la entre calle1"
                    required>
                <label> y </label>
                <input type="text" id="CALLE2" name="calle2" style="width:400px" placeholder="Ingrese la entre calle2"
                    required>
                <br>
                <br>
                <div style="float:left; margin-right:10px">
                    <label>Poste: </label>
                    <input type="text" id="POSTE" name="poste" style="width:400px"
                        placeholder="Ingrese la Dirección del Poste" required>
                </div>
                <button class="green" id="SUGERIR" style="width:90px; height: 25px; font-size: 13px">SUGERIR</button>
                <br>
                <br>
                <label>Metros RG11</label>
                <input type="text" id="METROS" name="metros" style="width:150px" placeholder="Metros de RG11" required>

            </div>
            <br>
            <label>Cantidad de pisos: </label>
            <input type="text" id="PISOS" name="pisos" style="width:150px" placeholder="Cantidad de Pisos" required>
            <br>
            <br>
            <label>Cantidad de UF: </label>
            <input type="text" id="UF" name="uf" style="width:150px" placeholder="Cantidad de UF" required>
            <br>
            <br>
            <label>Observacion: </label>
            <textarea id="OBS" name="obs" style="height: 40px; width: 50%"
                placeholder="Agregue la Observacion que crea necesaria"></textarea>
        </div>

        <div id="DIV2" style="font-size: 15px">
            <label>Valores que debe entregar la red:</label>
            <br>
            <br>
            <label>CH116:</label>
            <input type="text" id="CH116" name="ch116" style="width:98px">
            <br>
            <label>CH3:</label>
            <input type="text" id="CH3" name="ch3" style="width:114px">
            <br>
            <label>Retorno:</label>
            <input type="text" id="RETORNO" name="retorno" style="width:90px">
        </div>

        <div id="DIV3" style="font-size: 15px">
            <br>
            <label>Capacidad de tap hot:</label>
            <input type="text" id="TAPHOT" name="" style="width:100px">
        </div>

        <div id="DIV4" style="font-size: 15px">
            <br>
            <label>Disponibilidad para instalar Amplificador 90 [V]:</label>
            <select name="AMP90" id="AMP90" style="width:40px; height: 30px; font-size: 12px">
                <option value="SI">SI</option>
                <option value="NO">NO</option>
            </select>
        </div>

        <div id="DIV13" style="font-size: 15px">
            <br>
            <label>Tipo de Diseño realizado:</label>
            <select id="TARMADO" style="width:40px; height: 30px; font-size: 12px">
                <option value="-" selected></option>
                <option value="PASIVO">PASIVO</option>
                <option value="ACTIVO">ACTIVO</option>
            </select>
        </div>

        <div id="DIV5" style="font-size: 15px">
            <br>
            <label>Contacto 1:</label>
            <input type="text" id="CONTACTO1" name="contacto1" style="width:400px">
            <br>
            <br>
            <label>Contacto 2:</label>
            <input type="text" id="CONTACTO2" name="contacto2" style="width:400px">
            <br>
            <br>
            <label>Contacto 3:</label>
            <input type="text" id="CONTACTO3" name="contacto3" style="width:400px">
        </div>
        <br>
        <button class="action" id="guardar"
            style="margin-left:10px; width:100px; height: 35px; font-size: 15px">GENERAR</button>
        <button class="create" id="cancelar"
            style="margin-left:30px; width:100px; height: 35px; font-size: 15px">CANCELAR</button>

        <footer style="font-size: 15px">
            <br>
            <br>
            <label>Google App: Solicitar Reformas V2.12</label>
            <br>
            <label>By Ing. Ignacio Velazquez</label>
        </footer>

    </div>

    <div style="float:left; width=50%">
        <br>
        <br>
        <textarea id="PARRAFO" style="width:400px; height: 400px; font-size: 15px"></textarea>
        <br>
        <button class="green" id="COPIAR1" style="width:70px; height: 25px; font-size: 13px">COPIAR</button>

        <div style="font-size: 15px">
            <br>
            <br>
            <div style="float:left; margin-left:0px">
                <label>Ticket:</label>
                <input type="text" id="TICKET" name="ticket" style="width:120px">
            </div>
            <div id="DIV11" style="float:left; margin-left:10px">
                <select name="tipoticket" id="TIPOTICKET" style="width:130px; height: 30px; font-size: 12px">
                    <option value="" selected></option>
                    <option value="HOTTAP">HOT TAP</option>
                    <option value="NFP">No Contemplado</option>
                </select>
            </div>
            <div id="DIV10" style="float:left; margin-left:10px">
                <select name="tipoftth" id="TIPOFTTH" style="width:130px; height: 30px; font-size: 12px">
                    <option value="0" selected></option>
                    <option value="1">Normal</option>
                    <option value="2">HUAWEI</option>
                    <option value="3">Iluminacion</option>
                </select>
            </div>
            <br>
            <br>
            <input type="text" id="SALIDATICKET" name="salidaticket" style="width:100%"
                placeholder="Ingrese el Ticket de MOICA">
            <button class="green" id="COPIAR2" style="width:70px; height: 25px; font-size: 13px">COPIAR</button>
            <br>
            <br>
            <br>
            <label>TKT cerrado en CRM:</label>
            <button class="action" id="CONFIRMAR" style="width:100px; height: 25px; font-size: 13px">CONFIRMAR</button>

        </div>
    </div>


    <script>
        document.getElementById("DIV2").style.display = "none";
        document.getElementById("DIV3").style.display = "none";
        document.getElementById("DIV4").style.display = "none";
        document.getElementById("DIV5").style.display = "none";
        document.getElementById("DIV10").style.display = "none";
        document.getElementById("DIV13").style.display = "none";

        document.getElementById("buscar").addEventListener('click', () => {

            if (document.getElementById("ID").value == "") {
                window.alert("Debes ingresar un numero de ID");
                return
            }
            let ID = document.getElementById("ID").value;
            google.script.run.withSuccessHandler(function (output) {
                document.getElementById("DIRECCION").value = output[1];
                document.getElementById("NODO").value = output[0];
                document.getElementById("MAPA").href = "https://www.google.com/maps/search/?api=1&query=" + output[1].replace(/ /gi, '+');
                if ((document.getElementById("DIRECCION").value == "") && (document.getElementById("NODO").value == "")) {
                    window.alert(`El ID: ${ID} no fue ubicado dentro de la Planilla de Produccion`);
                    return
                }
            }).buscarID(ID);

        })

        let rotar = 0;
        document.getElementById("SUGERIR").addEventListener('click', () => {

            if (rotar == 2) {
                document.getElementById("POSTE").value = document.getElementById("CALLE2").value;
                rotar = 0;
                return;
            }

            if (rotar == 1) {
                document.getElementById("POSTE").value = document.getElementById("CALLE1").value;
                rotar = 2;
                return;
            }

            if (rotar == 0) {
                let cadena = document.getElementById("DIRECCION").value;
                for (let i = cadena.length; i > 0; i--) {
                    if (cadena[i] == " ") {
                        document.getElementById("POSTE").value = cadena.slice(0, i);
                        rotar = 1;
                        return;
                    }
                }
            }
        })



        document.getElementById("ARMADO").addEventListener('change', () => {
            let Armado = document.getElementById("ARMADO").value;

            if (Armado == "EXTERIOR") {
                document.getElementById("DIV2").style.display = "none";
            }
            if ((Armado == "MONTANTE") && (document.getElementById("RED").value == "2") && (document.getElementById("TIPO").value != "1")) {
                document.getElementById("DIV2").style.display = "block";
            }
        })

        let mensaje = "";
        document.getElementById("TIPO").addEventListener('change', () => {

            let Tipo = document.getElementById("TIPO").value;
            document.getElementById("RED").disabled = false;
            document.getElementById("ARMADO").disabled = false;
            document.getElementById("CONFIRMAR").disabled = false;
            document.getElementById("OBS").style.height = "40px";
            document.getElementById("OBS").value = "";
            if (Tipo == "1") {
                mensaje = "No hay tap hot disponible";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "block";
                document.getElementById("DIV11").style.display = "block";
                document.getElementById("DIV12").style.display = "block";
                document.getElementById("DIV4").style.display = "none";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("DIV10").style.display = "none";

            }
            if (Tipo == "2") {
                mensaje = "Edificio no contemplado";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "block";
                document.getElementById("DIV11").style.display = "block";
                document.getElementById("DIV12").style.display = "block";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("DIV10").style.display = "none";
            }
            if (Tipo == "3") {
                mensaje = "La administración no permite construir toma de tensión, por lo que no se puede instalar Amplificador 220 [V]";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "block";
                document.getElementById("DIV11").style.display = "block";
                document.getElementById("DIV12").style.display = "block";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("DIV10").style.display = "none";
            }
            if (Tipo == "4") {
                mensaje = "Niveles fuera de rango para los abonados";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "block";
                document.getElementById("DIV11").style.display = "block";
                document.getElementById("DIV12").style.display = "block";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("DIV10").style.display = "none";
            }
            if (Tipo == "5") {
                mensaje = "Obra civil - Edificio contemplado";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV10").style.display = "none";
                document.getElementById("DIV4").style.display = "block";
                document.getElementById("DIV5").style.display = "block";
                document.getElementById("DIV11").style.display = "block";
                document.getElementById("DIV12").style.display = "block";
                document.getElementById("OBS").value = "Se adjunta informe de relevamiento";
            }
            if (Tipo == "6") {
                mensaje = "Detalle de Empalme - FTTH";
                document.getElementById("DIV10").style.display = "block";
                document.getElementById("DIV11").style.display = "none";
                document.getElementById("DIV12").style.display = "none";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "none";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("RED").disabled = true;
                document.getElementById("ARMADO").disabled = true;
                document.getElementById("CONFIRMAR").disabled = true;
                document.getElementById("OBS").style.height = "100px";
                document.getElementById("OBS").value = "Para el edificio en cuestión se solicita:\n *- El detalle de empalme contemplando \n\nNota: Se adjunta el plano del diseño.";
                if ((document.getElementById("TICKET").value != "") && (document.getElementById("TIPOFTTH").value == "3")) {
                    document.getElementById("OBS").value = 'Para el edificio en cuestión se solicita:\n *- El detalle de empalme contemplando \n\nNota: Ticket generado en Moica ' + document.getElementById("TICKET").value + ' Motivo Iluminacion CAJA - FTTH \nNota: Se adjunta el plano del diseño.';

                }
            }
            if (Tipo == "7") {
                mensaje = "Extension de Red - FTTH";
                document.getElementById("DIV10").style.display = "block";
                document.getElementById("DIV11").style.display = "none";
                document.getElementById("DIV12").style.display = "none";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "none";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("RED").disabled = true;
                document.getElementById("ARMADO").disabled = true;
                document.getElementById("CONFIRMAR").disabled = true;
                document.getElementById("OBS").style.height = "100px";
                document.getElementById("OBS").value = "Para el edificio en cuestión se solicita:\n *- Contemplar la opción de extender la red sobre \n\nNota: Se adjunta el informe de relevamiento y el plano del diseño";
            }
            if (Tipo == "8") {
                mensaje = "Obra civil - FTTH";
                document.getElementById("DIV10").style.display = "block";
                document.getElementById("DIV11").style.display = "none";
                document.getElementById("DIV12").style.display = "none";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "none";
                document.getElementById("DIV5").style.display = "block";
                document.getElementById("RED").disabled = true;
                document.getElementById("ARMADO").disabled = true;
                document.getElementById("CONFIRMAR").disabled = true;
                document.getElementById("OBS").style.height = "100px";
                document.getElementById("OBS").value = "Para el edificio en cuestión se solicita:\n *- Contemplar acometida desde la cámara más cercana \n\nNota: Se adjunta informe detallando lo relevado";
            }
            if (Tipo == "9") {
                mensaje = "Iluminación de CAJA - FTTH";
                document.getElementById("DIV10").style.display = "block";
                document.getElementById("DIV11").style.display = "none";
                document.getElementById("DIV12").style.display = "none";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "none";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("RED").disabled = true;
                document.getElementById("ARMADO").disabled = true;
                document.getElementById("CONFIRMAR").disabled = true;
                document.getElementById("OBS").style.height = "100px";
                document.getElementById("OBS").value = 'Para el edificio en cuestión se solicita:\n *- Iluminación  de la caja HUB ' + document.getElementById("NODO").value + '-N01-H01 ya que se debe armar el edificio en cuestión. \n \nNota: Se adjunta el plano del diseño.';
            }
            if (Tipo == "10") {
                mensaje = "Se avanza con el diseño como ONLINE";
                document.getElementById("DIV2").style.display = "none";
                document.getElementById("DIV3").style.display = "none";
                document.getElementById("DIV4").style.display = "none";
                document.getElementById("DIV11").style.display = "block";
                document.getElementById("DIV12").style.display = "block";
                document.getElementById("DIV5").style.display = "none";
                document.getElementById("DIV10").style.display = "none";
                document.getElementById("DIV13").style.display = "block";
                document.getElementById("OBS").style.height = "100px";
                document.getElementById("OBS").value = '\nLa gestion se avanza a solicitud de Diseño Online\n *- Se realizo un ARMADO ' + document.getElementById("TARMADO").value + ' por indicaciones del relevamiento\n *- Se dejo RG11 en punta en poste para su posterior conexion ';
            }

        })


        document.getElementById("guardar").addEventListener('click', () => {

            ID = document.getElementById("ID").value;
            let FORMATO = "";

            if ((document.getElementById("TIPO").value != "6") && (document.getElementById("TIPO").value != "7") && (document.getElementById("TIPO").value != "8") && (document.getElementById("TIPO").value != "9")) {
                if (document.getElementById("ID").value == "") {
                    window.alert("Debes ingresar un numero de ID");
                    return
                }
                if (document.getElementById("NODO").value == "") {
                    window.alert("Debes ingresar un NODO");
                    return
                }
                if (document.getElementById("DIRECCION").value == "") {
                    window.alert("Debes ingresar una Direccion");
                    return
                }
                if (document.getElementById("CALLE1").value == "") {
                    window.alert("Debes ingresar la entrecalle 1");
                    return
                }
                if (document.getElementById("CALLE2").value == "") {
                    window.alert("Debes ingresar la entrecalle 2");
                    return
                }
                if (document.getElementById("POSTE").value == "") {
                    window.alert("Debes ingresar la altura del poste");
                    return
                }
                if (document.getElementById("METROS").value == "") {
                    window.alert("Debes ingresar los Mts de RG11");
                    return
                }
                if (document.getElementById("PISOS").value == "") {
                    window.alert("Debes ingresar los pisos del Edif");
                    return
                }
                if (document.getElementById("UF").value == "") {
                    window.alert("Debes ingresar las UF del Edif");
                    return
                }


                FORMATO = `Motivo: ${mensaje}\nDistribución: ${document.getElementById("ARMADO").value}\nID: ${document.getElementById("ID").value}\nNodo: ${document.getElementById("NODO").value}\nDirección: ${document.getElementById("DIRECCION").value}\nEntre calles: ${document.getElementById("CALLE1").value.toUpperCase()} y ${document.getElementById("CALLE2").value.toUpperCase()}\nPoste: ${document.getElementById("POSTE").value}\nRG11: ${document.getElementById("METROS").value} metros\nCantidad de pisos: ${document.getElementById("PISOS").value}\nCantidad de UF: ${document.getElementById("UF").value}\n`;


                if ((document.getElementById("TIPO").value == "1") && (document.getElementById("RED").value == "1")) {
                    if (document.getElementById("TAPHOT").value == "") {
                        window.alert("Debes ingresar la capacidad de la Tap Hot a instalar");
                        return
                    }
                    FORMATO = FORMATO + `Capacidad de Tap Hot: ${document.getElementById("TAPHOT").value}\n`;
                }

                if ((document.getElementById("TIPO").value == "2") && (document.getElementById("RED").value == "2") && (document.getElementById("ARMADO").value == "EXTERIOR")) {
                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                }

                if ((document.getElementById("TIPO").value == "2") && (document.getElementById("RED").value == "2") && (document.getElementById("ARMADO").value == "MONTANTE")) {
                    if ((document.getElementById("CH116").value == "") || (document.getElementById("CH3").value == "") || (document.getElementById("RETORNO").value == "")) {
                        window.alert("Debes ingresar todos los valores de la Montante");
                        return
                    }
                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                    FORMATO = FORMATO + `Valores que debe entregar la red:\nCh116: ${document.getElementById("CH116").value} dBmV\nCh3: ${document.getElementById("CH3").value} dBmV\nRetorno: ${document.getElementById("RETORNO").value} dBmV\n`;
                }

                if ((document.getElementById("TIPO").value == "3") && (document.getElementById("ARMADO").value == "EXTERIOR")) {
                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                }

                if ((document.getElementById("TIPO").value == "3") && (document.getElementById("ARMADO").value == "MONTANTE")) {
                    if ((document.getElementById("CH116").value == "") || (document.getElementById("CH3").value == "") || (document.getElementById("RETORNO").value == "")) {
                        window.alert("Debes ingresar todos los valores de la Montante");
                        return
                    }
                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                    FORMATO = FORMATO + `Valores que debe entregar la red:\nCh116: ${document.getElementById("CH116").value} dBmV\nCh3: ${document.getElementById("CH3").value} dBmV\nRetorno: ${document.getElementById("RETORNO").value} dBmV\n`;
                }

                if ((document.getElementById("TIPO").value == "4") && (document.getElementById("ARMADO").value == "EXTERIOR")) {
                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                }

                if ((document.getElementById("TIPO").value == "4") && (document.getElementById("ARMADO").value == "MONTANTE")) {
                    if ((document.getElementById("CH116").value == "") || (document.getElementById("CH3").value == "") || (document.getElementById("RETORNO").value == "")) {
                        window.alert("Debes ingresar todos los valores de la Montante");
                        return
                    }
                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                    FORMATO = FORMATO + `Valores que debe entregar la red:\nCh116: ${document.getElementById("CH116").value} dBmV\nCh3: ${document.getElementById("CH3").value} dBmV\nRetorno: ${document.getElementById("RETORNO").value} dBmV\n`;
                }

                if ((document.getElementById("TIPO").value == "5") && (document.getElementById("ARMADO").value == "EXTERIOR")) {
                    if (document.getElementById("CONTACTO1").value == "") {
                        window.alert("Debes ingresar al menos 1 contacto para la gestion");
                        return
                    }
                    if (document.getElementById("CONTACTO1").value != "") {
                        FORMATO = FORMATO + `Contacto 1: ${document.getElementById("CONTACTO1").value}\n`
                    }
                    if (document.getElementById("CONTACTO2").value != "") {
                        FORMATO = FORMATO + `Contacto 2: ${document.getElementById("CONTACTO2").value}\n`
                    }
                    if (document.getElementById("CONTACTO3").value != "") {
                        FORMATO = FORMATO + `Contacto 3: ${document.getElementById("CONTACTO3").value}\n`
                    }

                    FORMATO = FORMATO + `Disponibilidad para instalar Amplificador 90 [V]: ${document.getElementById("AMP90").value}\n`;
                }

                if (document.getElementById("OBS").value != "") {
                    FORMATO = FORMATO + `Observación: ${document.getElementById("OBS").value}\n`;
                }

                document.getElementById("PARRAFO").value = FORMATO;

            }
            else {
                if (document.getElementById("ID").value == "") {
                    window.alert("Debes ingresar un numero de ID");
                    return
                }
                if (document.getElementById("NODO").value == "") {
                    window.alert("Debes ingresar un NODO");
                    return
                }
                if (document.getElementById("DIRECCION").value == "") {
                    window.alert("Debes ingresar una Direccion");
                    return
                }
                if (document.getElementById("PISOS").value == "") {
                    window.alert("Debes ingresar los pisos del Edif");
                    return
                }
                if (document.getElementById("UF").value == "") {
                    window.alert("Debes ingresar las UF del Edif");
                    return
                }

                FORMATO = `Motivo: ${mensaje}\nID: ${document.getElementById("ID").value}\nNodo: ${document.getElementById("NODO").value}\nDirección: ${document.getElementById("DIRECCION").value}\nCantidad de pisos: ${document.getElementById("PISOS").value}\nCantidad de UF: ${document.getElementById("UF").value}\n`;


                if (document.getElementById("TIPO").value == "8") {
                    if (document.getElementById("CONTACTO1").value == "") {
                        window.alert("Debes ingresar al menos 1 contacto para la gestion");
                        return
                    }
                    if (document.getElementById("CONTACTO1").value != "") {
                        FORMATO = FORMATO + `\nContacto 1: ${document.getElementById("CONTACTO1").value}\n`
                    }
                    if (document.getElementById("CONTACTO2").value != "") {
                        FORMATO = FORMATO + `Contacto 2: ${document.getElementById("CONTACTO2").value}\n`
                    }
                    if (document.getElementById("CONTACTO3").value != "") {
                        FORMATO = FORMATO + `Contacto 3: ${document.getElementById("CONTACTO3").value}\n`
                    }
                }


                if (document.getElementById("OBS").value != "") {
                    FORMATO = FORMATO + `\nObservación: ${document.getElementById("OBS").value}\n`;
                }

                document.getElementById("PARRAFO").value = FORMATO;

            }
        })


        document.getElementById("cancelar").addEventListener('click', () => {
            limpiar();
        })



        document.getElementById("TIPOTICKET").addEventListener('change', () => {

            let tipoticket = document.getElementById("TIPOTICKET").value;

            if (document.getElementById("TICKET").value == "") {
                window.alert("Debes ingresar el numero de Ticket generado en MOICA");
                document.getElementById("TIPOTICKET").value = "";
                return
            }
            if (tipoticket == "HOTTAP") {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo HOT TAP`;
            }
            if (tipoticket == "NFP") {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo Edificio No Contemplado`;
            }
        })

        document.getElementById("TIPOFTTH").addEventListener('change', () => {

            let tipoftth = document.getElementById("TIPOFTTH").value;

            if (document.getElementById("TICKET").value == "") {
                window.alert("Debes ingresar el numero de Ticket generado en MOICA");
                document.getElementById("TIPOTICKET").value = "";
                document.getElementById("TIPOFTTH").value = 0;
                return
            }
            if ((tipoftth == "1") && (document.getElementById("TIPO").value == "6")) {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo FTTH Empalme`;
            }
            if ((tipoftth == "1") && (document.getElementById("TIPO").value == "7")) {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo FTTH Extensión de Red`;
            }
            if ((tipoftth == "1") && (document.getElementById("TIPO").value == "8")) {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo FTTH Obra Civil`;
            }
            if ((tipoftth == "2") && (document.getElementById("TIPO").value == "6")) {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo FTTH Empalme Huawei`;
            }
            if ((tipoftth == "3") && (document.getElementById("TIPO").value == "9")) {
                document.getElementById("SALIDATICKET").value = `Ticket generado en Moica ${document.getElementById("TICKET").value} Motivo Iluminacion CAJA - FTTH`;
            }
        })

        document.getElementById("TARMADO").addEventListener('change', () => {

            document.getElementById("OBS").value = '\nLa gestion se avanza a solicitud de Diseño Online\n *- Se realizo un ARMADO ' + document.getElementById("TARMADO").value + ' por indicaciones del relevamiento\n *- Se dejo RG11 en punta en poste para su posterior conexion ';

        })


        document.getElementById("COPIAR2").addEventListener('click', () => {
            pasos = 1;
            var codigoACopiar2 = document.getElementById('SALIDATICKET');
            codigoACopiar2.select();
            codigoACopiar2.setSelectionRange(0, 99999);

            document.execCommand('copy');

        })

        document.getElementById("COPIAR1").addEventListener('click', () => {

            var codigoACopiar1 = document.getElementById('PARRAFO');
            codigoACopiar1.select();
            codigoACopiar1.setSelectionRange(0, 99999);

            document.execCommand('copy');

        })
        let pasos = 0;
        document.getElementById("CONFIRMAR").addEventListener('click', () => {
            if (pasos == 0) {
                window.alert("DEBES DE COMPLETAR TODO EL PROCESO ANTES DE CONFIRMAR");
            }
            if (pasos == 1) {
                if (document.getElementById("ID").value == "") {
                    window.alert("Debes ingresar un numero de ID");
                    return
                }
                ID = document.getElementById("ID").value;
                google.script.run.Escribir(ID, "TKT Generado");
                pasos = 0;
                setTimeout(function () {
                    window.alert("Ticket confirmado correctamente");
                    limpiar();
                }, 2000);
            }

        })

        function limpiar() {
            document.getElementById("ID").value = "";
            document.getElementById("TIPO").value = 0;
            document.getElementById("RED").value = 0;
            document.getElementById("ARMADO").value = 0;
            document.getElementById("DIRECCION").value = "";
            document.getElementById("NODO").value = "";
            document.getElementById("CALLE1").value = "";
            document.getElementById("CALLE2").value = "";
            document.getElementById("POSTE").value = "";
            document.getElementById("METROS").value = "";
            document.getElementById("PISOS").value = "";
            document.getElementById("UF").value = "";
            document.getElementById("CH116").value = "";
            document.getElementById("CH3").value = "";
            document.getElementById("RETORNO").value = "";
            document.getElementById("TAPHOT").value = "";
            document.getElementById("CONTACTO1").value = "";
            document.getElementById("CONTACTO2").value = "";
            document.getElementById("CONTACTO3").value = "";
            document.getElementById("OBS").value = "";
            document.getElementById("TICKET").value = "";
            document.getElementById("TIPOTICKET").value = "";
            document.getElementById("TIPOFTTH").value = 0;
            document.getElementById("SALIDATICKET").value = "";
            document.getElementById("PARRAFO").value = "";
            document.getElementById("DIV2").style.display = "none";
            document.getElementById("DIV3").style.display = "none";
            document.getElementById("DIV4").style.display = "none";
            document.getElementById("DIV5").style.display = "none";
            document.getElementById("RED").disabled = false;
            document.getElementById("ARMADO").disabled = false;
        }

    </script>

</body>